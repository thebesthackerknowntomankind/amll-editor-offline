import{r as H,_ as be,N as Te,K as _e,O as ue,j as l,bT as se,af as Se,aa as je,ac as ye,Q as We,W as Ce,cN as Ie,ae as he,cO as Ne,D as Le,U as ve,J as Ae,M as Me,V as ze,a0 as Re,ag as le,a2 as Be,aj as Ve,ak as Ee,ai as ke,a3 as De,am as Ge}from"./index-BSiqX_A-.js";import{R as ie,a as Ye}from"./common-b13lmT4-.js";import{c as ge}from"./separator-YBp1qwL_.js";import{y as Fe,I as $e}from"./radio-group-D6mt1Sf7.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(i,t){return this.cache.has(i)?this.cache.get(i):(this.cache.set(i,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(i,t){return this.cache.has(i)?this.cache.get(i):(this.cache.set(i,t),t)}};const me=Symbol("multiple-values");function ee(i){const t=be.c(55),{label:e,isWordField:r,fieldName:s,formatter:T,parser:a,textFieldStyle:d}=i,[c,n]=H.useState(void 0),[h,f]=H.useState(""),o=r?ve:Ae,B=Te(ue),{t:g}=_e(),u=Ce(Ie),[b,L]=he(Ne),x=H.useRef(null);let p,y;t[0]!==s||t[1]!==r||t[2]!==b||t[3]!==L?(p=()=>{b===s&&!r&&x.current&&(x.current.focus(),L(null))},y=[b,s,r,L],t[0]=s,t[1]=r,t[2]=b,t[3]=L,t[4]=p,t[5]=y):(p=t[4],y=t[5]),H.useEffect(p,y);let m;t[6]!==s||t[7]!==r||t[8]!==o?(m=Le(M=>{if(s!=="startTime"&&s!=="endTime")return!1;const A=M(o);if(A.size===0)return!1;const Y=M(ue);if(r){const W=A;for(const v of Y.lyricLines)for(const S of v.words)if(W.has(S.id)&&S.startTime>S.endTime)return!0}else{const W=A;for(const v of Y.lyricLines)if(W.has(v.id)&&v.startTime>v.endTime)return!0}return!1}),t[6]=s,t[7]=r,t[8]=o,t[9]=m):m=t[9];const F=Me(m);let w;t[10]!==s||t[11]!==T||t[12]!==r||t[13]!==o?(w=Le(M=>{const A=M(o),Y=M(ue);if(A.size===0)return;if(r){const S=A,X=new Set;for(const te of Y.lyricLines)for(const Z of te.words)S.has(Z.id)&&X.add(Z[s]);return X.size===1?T(X.values().next().value):me}const W=A,v=new Set;for(const S of Y.lyricLines)W.has(S.id)&&v.add(S[s]);return v.size===1?T(v.values().next().value):me}),t[10]=s,t[11]=T,t[12]=r,t[13]=o,t[14]=w):w=t[14];const j=Me(w),I=ze();let N;t[15]!==j||t[16]!==B||t[17]!==s||t[18]!==r||t[19]!==o||t[20]!==a||t[21]!==I?(N=M=>{try{const A=I.get(o),Y=a(M);B(W=>{for(const v of W.lyricLines)if(r)for(const S of v.words)A.has(S.id)&&(S[s]=Y);else A.has(v.id)&&(v[s]=Y);return W})}catch{typeof j=="string"&&n(j)}},t[15]=j,t[16]=B,t[17]=s,t[18]=r,t[19]=o,t[20]=a,t[21]=I,t[22]=N):N=t[22];const z=N;let $,P;t[23]!==j||t[24]!==g?($=()=>{j===me?(n(""),f(g("ribbonBar.editMode.multipleValues","多个值..."))):(n(j),f(""))},P=[j,g],t[23]=j,t[24]=g,t[25]=$,t[26]=P):($=t[25],P=t[26]),H.useLayoutEffect($,P);let R;t[27]!==e?(R=l.jsx(le,{wrap:"nowrap",size:"1",children:e}),t[27]=e,t[28]=R):R=t[28];const U=F?"red":void 0,K=F?"soft":void 0;let V;t[29]!==d?(V={width:"8em",...d},t[29]=d,t[30]=V):V=t[30];const J=c??"",Q=c===void 0;let O;t[31]===Symbol.for("react.memo_cache_sentinel")?(O=M=>n(M.currentTarget.value),t[31]=O):O=t[31];let E;t[32]!==z?(E=M=>{M.key==="Enter"&&z(M.currentTarget.value)},t[32]=z,t[33]=E):E=t[33];let k;t[34]!==s||t[35]!==r||t[36]!==u?(k=()=>{!r&&(s==="startTime"||s==="endTime")&&u({isWord:!1,field:s})},t[34]=s,t[35]=r,t[36]=u,t[37]=k):k=t[37];let D;t[38]!==j||t[39]!==z||t[40]!==u?(D=M=>{u(null),M.currentTarget.value!==j&&z(M.currentTarget.value)},t[38]=j,t[39]=z,t[40]=u,t[41]=D):D=t[41];let G;t[42]!==h||t[43]!==K||t[44]!==V||t[45]!==J||t[46]!==Q||t[47]!==E||t[48]!==k||t[49]!==D||t[50]!==U?(G=l.jsx(De,{ref:x,size:"1",color:U,variant:K,style:V,value:J,placeholder:h,disabled:Q,onChange:O,onKeyDown:E,onFocus:k,onBlur:D}),t[42]=h,t[43]=K,t[44]=V,t[45]=J,t[46]=Q,t[47]=E,t[48]=k,t[49]=D,t[50]=U,t[51]=G):G=t[51];let q;return t[52]!==G||t[53]!==R?(q=l.jsxs(l.Fragment,{children:[R,G]}),t[52]=G,t[53]=R,t[54]=q):q=t[54],q}function we(i){const t=be.c(23),{label:e,isWordField:r,fieldName:s,defaultValue:T}=i,a=r?ve:Ae,d=Te(ue),c=ze();let n;t[0]!==s||t[1]!==r||t[2]!==a?(n=Le(m=>{const _=m(a),F=m(ue);if(_.size){if(r){const j=_,I=new Set;for(const N of F.lyricLines)for(const z of N.words)j.has(z.id)&&I.add(z[s]);return I.size===1?I.values().next().value:me}const w=_,C=new Set;for(const j of F.lyricLines)w.has(j.id)&&C.add(j[s]);return C.size===1?C.values().next().value:me}}),t[0]=s,t[1]=r,t[2]=a,t[3]=n):n=t[3];const f=Me(n);let o;t[4]!==a?(o=Le(m=>m(a).size===0),t[4]=a,t[5]=o):o=t[5];const g=Me(o),u=H.useId();let b;t[6]!==u||t[7]!==e?(b=l.jsx(le,{wrap:"nowrap",size:"1",children:l.jsx("label",{htmlFor:u,children:e})}),t[6]=u,t[7]=e,t[8]=b):b=t[8];const L=f?f===me?"indeterminate":f:T;let x;t[9]!==d||t[10]!==s||t[11]!==r||t[12]!==a||t[13]!==c?(x=m=>{m!=="indeterminate"&&d(_=>{const F=c.get(a);for(const w of _.lyricLines)if(r)for(const C of w.words)F.has(C.id)&&(C[s]=m);else F.has(w.id)&&(w[s]=m);return _})},t[9]=d,t[10]=s,t[11]=r,t[12]=a,t[13]=c,t[14]=x):x=t[14];let p;t[15]!==u||t[16]!==g||t[17]!==L||t[18]!==x?(p=l.jsx(ge,{disabled:g,id:u,checked:L,onCheckedChange:x}),t[15]=u,t[16]=g,t[17]=L,t[18]=x,t[19]=p):p=t[19];let y;return t[20]!==b||t[21]!==p?(y=l.jsxs(l.Fragment,{children:[b,p]}),t[20]=b,t[21]=p,t[22]=y):y=t[22],y}function Pe(i){const t=be.c(13),{simpleModeLabel:e,advanceModeLabel:r}=i,s=e===void 0?"简单模式":e,T=r===void 0?"高级模式":r,[a,d]=he(Re);let c;t[0]!==d?(c=B=>d(B),t[0]=d,t[1]=c):c=t[1];let n;t[2]!==s?(n=l.jsx(le,{wrap:"nowrap",size:"1",children:l.jsx(Fe,{value:Be.Simple,children:s})}),t[2]=s,t[3]=n):n=t[3];let h;t[4]!==T?(h=l.jsx(le,{wrap:"nowrap",size:"1",children:l.jsx(Fe,{value:Be.Advance,children:T})}),t[4]=T,t[5]=h):h=t[5];let f;t[6]!==n||t[7]!==h?(f=l.jsxs(Ge,{gapY:"3",direction:"column",children:[n,h]}),t[6]=n,t[7]=h,t[8]=f):f=t[8];let o;return t[9]!==a||t[10]!==c||t[11]!==f?(o=l.jsx($e,{value:a,onValueChange:c,size:"1",children:f}),t[9]=a,t[10]=c,t[11]=f,t[12]=o):o=t[12],o}const Oe=()=>{const i=be.c(40),[t,e]=he(Ve),[r,s]=he(Ee),[T,a]=he(ke),{t:d}=_e(),c=H.useId(),n=H.useId(),h=H.useId();let f;i[0]!==d?(f=d("ribbonBar.editMode.showTranslation","显示翻译行"),i[0]=d,i[1]=f):f=i[1];let o;i[2]!==c||i[3]!==f?(o=l.jsx(le,{size:"1",asChild:!0,children:l.jsx("label",{htmlFor:c,children:f})}),i[2]=c,i[3]=f,i[4]=o):o=i[4];let B;i[5]!==e?(B=w=>e(!!w),i[5]=e,i[6]=B):B=i[6];let g;i[7]!==c||i[8]!==t||i[9]!==B?(g=l.jsx(ge,{id:c,checked:t,onCheckedChange:B}),i[7]=c,i[8]=t,i[9]=B,i[10]=g):g=i[10];let u;i[11]!==d?(u=d("ribbonBar.editMode.showRomanization","显示音译行"),i[11]=d,i[12]=u):u=i[12];let b;i[13]!==n||i[14]!==u?(b=l.jsx(le,{size:"1",asChild:!0,children:l.jsx("label",{htmlFor:n,children:u})}),i[13]=n,i[14]=u,i[15]=b):b=i[15];let L;i[16]!==s?(L=w=>s(!!w),i[16]=s,i[17]=L):L=i[17];let x;i[18]!==n||i[19]!==r||i[20]!==L?(x=l.jsx(ge,{id:n,checked:r,onCheckedChange:L}),i[18]=n,i[19]=r,i[20]=L,i[21]=x):x=i[21];let p;i[22]!==d?(p=d("ribbonBar.editMode.showWordRomanizationInput","显示逐字音译"),i[22]=d,i[23]=p):p=i[23];let y;i[24]!==h||i[25]!==p?(y=l.jsx(le,{size:"1",asChild:!0,children:l.jsx("label",{htmlFor:h,children:p})}),i[24]=h,i[25]=p,i[26]=y):y=i[26];let m;i[27]!==a?(m=w=>a(!!w),i[27]=a,i[28]=m):m=i[28];let _;i[29]!==h||i[30]!==T||i[31]!==m?(_=l.jsx(ge,{id:h,checked:T,onCheckedChange:m}),i[29]=h,i[30]=T,i[31]=m,i[32]=_):_=i[32];let F;return i[33]!==o||i[34]!==_||i[35]!==g||i[36]!==b||i[37]!==x||i[38]!==y?(F=l.jsxs(se,{columns:"1fr auto",gapX:"4",gapY:"1",flexGrow:"1",align:"center",children:[o,g,b,x,y,_]}),i[33]=o,i[34]=_,i[35]=g,i[36]=b,i[37]=x,i[38]=y,i[39]=F):F=i[39],F},ot=H.forwardRef((i,t)=>{const e=be.c(136),r=Te(ue),{t:s}=_e();let T;e[0]!==s?(T=s("ribbonBar.editMode.new","新建"),e[0]=s,e[1]=T):T=e[1];let a;e[2]!==r?(a=()=>r(qe),e[2]=r,e[3]=a):a=e[3];let d;e[4]!==s?(d=s("ribbonBar.editMode.lyricLine","歌词行"),e[4]=s,e[5]=d):d=e[5];let c;e[6]!==a||e[7]!==d?(c=l.jsx(se,{columns:"1",gap:"1",gapY:"1",flexGrow:"1",align:"center",children:l.jsx(Se,{size:"1",variant:"soft",onClick:a,children:d})}),e[6]=a,e[7]=d,e[8]=c):c=e[8];let n;e[9]!==T||e[10]!==c?(n=l.jsx(ie,{label:T,children:c}),e[9]=T,e[10]=c,e[11]=n):n=e[11];let h;e[12]!==s?(h=s("ribbonBar.editMode.lineTiming","行时间戳"),e[12]=s,e[13]=h):h=e[13];let f;e[14]!==s?(f=s("ribbonBar.editMode.startTime","起始时间"),e[14]=s,e[15]=f):f=e[15];let o;e[16]!==f?(o=l.jsx(ee,{label:f,fieldName:"startTime",parser:ye,formatter:je}),e[16]=f,e[17]=o):o=e[17];let B;e[18]!==s?(B=s("ribbonBar.editMode.endTime","结束时间"),e[18]=s,e[19]=B):B=e[19];let g;e[20]!==B?(g=l.jsx(ee,{label:B,fieldName:"endTime",parser:ye,formatter:je}),e[20]=B,e[21]=g):g=e[21];let u;e[22]!==o||e[23]!==g?(u=l.jsxs(se,{columns:"0fr 1fr",gap:"2",gapY:"1",flexGrow:"1",align:"center",children:[o,g]}),e[22]=o,e[23]=g,e[24]=u):u=e[24];let b;e[25]!==u||e[26]!==h?(b=l.jsx(ie,{label:h,children:u}),e[25]=u,e[26]=h,e[27]=b):b=e[27];let L;e[28]!==s?(L=s("ribbonBar.editMode.lineProperties","行属性"),e[28]=s,e[29]=L):L=e[29];let x;e[30]!==s?(x=s("ribbonBar.editMode.bgLyric","背景歌词"),e[30]=s,e[31]=x):x=e[31];let p;e[32]!==x?(p=l.jsx(we,{label:x,defaultValue:!1,isWordField:!1,fieldName:"isBG"}),e[32]=x,e[33]=p):p=e[33];let y;e[34]!==s?(y=s("ribbonBar.editMode.duetLyric","对唱歌词"),e[34]=s,e[35]=y):y=e[35];let m;e[36]!==y?(m=l.jsx(we,{label:y,isWordField:!1,fieldName:"isDuet",defaultValue:!1}),e[36]=y,e[37]=m):m=e[37];let _;e[38]!==s?(_=s("ribbonBar.editMode.ignoreSync","忽略打轴"),e[38]=s,e[39]=_):_=e[39];let F;e[40]!==_?(F=l.jsx(we,{label:_,isWordField:!1,fieldName:"ignoreSync",defaultValue:!1}),e[40]=_,e[41]=F):F=e[41];let w;e[42]!==p||e[43]!==m||e[44]!==F?(w=l.jsxs(se,{columns:"0fr 0fr",gap:"4",gapY:"1",flexGrow:"1",align:"center",children:[p,m,F]}),e[42]=p,e[43]=m,e[44]=F,e[45]=w):w=e[45];let C;e[46]!==L||e[47]!==w?(C=l.jsx(ie,{label:L,children:w}),e[46]=L,e[47]=w,e[48]=C):C=e[48];let j;e[49]!==s?(j=s("ribbonBar.editMode.wordTiming","词时间戳"),e[49]=s,e[50]=j):j=e[50];let I;e[51]!==s?(I=s("ribbonBar.editMode.startTime","起始时间"),e[51]=s,e[52]=I):I=e[52];let N;e[53]!==I?(N=l.jsx(ee,{label:I,fieldName:"startTime",isWordField:!0,parser:ye,formatter:je}),e[53]=I,e[54]=N):N=e[54];let z;e[55]!==s?(z=s("ribbonBar.editMode.endTime","结束时间"),e[55]=s,e[56]=z):z=e[56];let $;e[57]!==z?($=l.jsx(ee,{label:z,fieldName:"endTime",isWordField:!0,parser:ye,formatter:je}),e[57]=z,e[58]=$):$=e[58];let P;e[59]!==s?(P=s("ribbonBar.editMode.emptyBeatCount","空拍数量"),e[59]=s,e[60]=P):P=e[60];let R;e[61]!==P?(R=l.jsx(ee,{label:P,fieldName:"emptyBeat",isWordField:!0,parser:Ue,formatter:String}),e[61]=P,e[62]=R):R=e[62];let U;e[63]!==N||e[64]!==$||e[65]!==R?(U=l.jsxs(se,{columns:"0fr 1fr",gap:"2",gapY:"1",flexGrow:"1",align:"center",children:[N,$,R]}),e[63]=N,e[64]=$,e[65]=R,e[66]=U):U=e[66];let K;e[67]!==j||e[68]!==U?(K=l.jsx(ie,{label:j,children:U}),e[67]=j,e[68]=U,e[69]=K):K=e[69];let V;e[70]!==s?(V=s("ribbonBar.editMode.wordProperties","单词属性"),e[70]=s,e[71]=V):V=e[71];let J;e[72]!==s?(J=s("ribbonBar.editMode.wordContent","单词内容"),e[72]=s,e[73]=J):J=e[73];let Q;e[74]!==J?(Q=l.jsx(ee,{label:J,fieldName:"word",isWordField:!0,parser:Ke,formatter:Je}),e[74]=J,e[75]=Q):Q=e[75];let O;e[76]!==s?(O=s("ribbonBar.editMode.romanWord","单词音译"),e[76]=s,e[77]=O):O=e[77];let E;e[78]!==O?(E=l.jsx(ee,{label:O,fieldName:"romanWord",isWordField:!0,parser:Qe,formatter:Xe}),e[78]=O,e[79]=E):E=e[79];let k;e[80]!==s?(k=s("ribbonBar.editMode.obscene","不雅用语"),e[80]=s,e[81]=k):k=e[81];let D;e[82]!==k?(D=l.jsx(we,{label:k,isWordField:!0,fieldName:"obscene",defaultValue:!1}),e[82]=k,e[83]=D):D=e[83];let G;e[84]!==Q||e[85]!==E||e[86]!==D?(G=l.jsxs(se,{columns:"0fr 1fr",gap:"2",gapY:"1",flexGrow:"1",align:"center",children:[Q,E,D]}),e[84]=Q,e[85]=E,e[86]=D,e[87]=G):G=e[87];let q;e[88]!==V||e[89]!==G?(q=l.jsx(ie,{label:V,children:G}),e[88]=V,e[89]=G,e[90]=q):q=e[90];let M;e[91]!==s?(M=s("ribbonBar.editMode.secondaryContent","次要内容"),e[91]=s,e[92]=M):M=e[92];let A;e[93]!==s?(A=s("ribbonBar.editMode.translatedLyric","翻译歌词"),e[93]=s,e[94]=A):A=e[94];let Y;e[95]===Symbol.for("react.memo_cache_sentinel")?(Y={width:"20em"},e[95]=Y):Y=e[95];let W;e[96]!==A?(W=l.jsx(ee,{label:A,fieldName:"translatedLyric",parser:He,formatter:Ze,textFieldStyle:Y}),e[96]=A,e[97]=W):W=e[97];let v;e[98]!==s?(v=s("ribbonBar.editMode.romanLyric","音译歌词"),e[98]=s,e[99]=v):v=e[99];let S;e[100]===Symbol.for("react.memo_cache_sentinel")?(S={width:"20em"},e[100]=S):S=e[100];let X;e[101]!==v?(X=l.jsx(ee,{label:v,fieldName:"romanLyric",parser:et,formatter:tt,textFieldStyle:S}),e[101]=v,e[102]=X):X=e[102];let te;e[103]!==W||e[104]!==X?(te=l.jsxs(se,{columns:"0fr 1fr",gap:"2",gapY:"1",flexGrow:"1",align:"center",children:[W,X]}),e[103]=W,e[104]=X,e[105]=te):te=e[105];let Z;e[106]!==M||e[107]!==te?(Z=l.jsx(ie,{label:M,children:te}),e[106]=M,e[107]=te,e[108]=Z):Z=e[108];let re;e[109]!==s?(re=s("ribbonBar.editMode.layoutMode","布局模式"),e[109]=s,e[110]=re):re=e[110];let oe;e[111]!==s?(oe=s("settings.common.layoutModeOptions.simple","简单模式"),e[111]=s,e[112]=oe):oe=e[112];let ne;e[113]!==s?(ne=s("settings.common.layoutModeOptions.advance","高级模式"),e[113]=s,e[114]=ne):ne=e[114];let ae;e[115]!==oe||e[116]!==ne?(ae=l.jsx(Pe,{simpleModeLabel:oe,advanceModeLabel:ne}),e[115]=oe,e[116]=ne,e[117]=ae):ae=e[117];let de;e[118]!==re||e[119]!==ae?(de=l.jsx(ie,{label:re,children:ae}),e[118]=re,e[119]=ae,e[120]=de):de=e[120];let ce;e[121]!==s?(ce=s("ribbonBar.editMode.auxiliaryLineDisplay","辅助行显示"),e[121]=s,e[122]=ce):ce=e[122];let pe;e[123]===Symbol.for("react.memo_cache_sentinel")?(pe=l.jsx(Oe,{}),e[123]=pe):pe=e[123];let fe;e[124]!==ce?(fe=l.jsx(ie,{label:ce,children:pe}),e[124]=ce,e[125]=fe):fe=e[125];let xe;return e[126]!==t||e[127]!==b||e[128]!==C||e[129]!==K||e[130]!==q||e[131]!==n||e[132]!==Z||e[133]!==de||e[134]!==fe?(xe=l.jsxs(Ye,{ref:t,children:[n,b,C,K,q,Z,de,fe]}),e[126]=t,e[127]=b,e[128]=C,e[129]=K,e[130]=q,e[131]=n,e[132]=Z,e[133]=de,e[134]=fe,e[135]=xe):xe=e[135],xe});function qe(i){i.lyricLines.push(We())}function Ue(i){const t=Number.parseInt(i,10);return Number.isNaN(t)?0:t}function Ke(i){return i}function Je(i){return i}function Qe(i){return i}function Xe(i){return i||""}function He(i){return i}function Ze(i){return i}function et(i){return i}function tt(i){return i}export{ot as EditModeRibbonBar,ot as default};
//# sourceMappingURL=edit-mode-DwYMisWB.js.map
